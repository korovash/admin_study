# Учебная программа — DevOps пет-проект (VM + Python + Postgres + Nginx)

## Шаг 0. Подготовка окружения (установка VirtualBox и Rocky Linux)

### Теория и навыки
- Установка гипервизора VirtualBox (Windows, Linux или macOS).
- Загрузка ISO-образа Rocky Linux (например, 9.x) с официального сайта.
- Создание виртуальной машины в VirtualBox:
  - Новый → имя `rocky-devops`, тип Linux, версия Red Hat (64-bit).
  - Выделить минимум 2 ГБ RAM (лучше 4 ГБ) и 20 ГБ HDD.
  - Указать ISO-образ для установки.
- Установка ОС Rocky Linux пошагово:
  - Выбор языка и раскладки клавиатуры.
  - Настройка диска (автоматическая разметка).
  - Создание пользователя `admin` и установка root-пароля.
  - Настройка сетевого интерфейса (включить DHCP).
  - Запуск установки.
- Первоначальная настройка после загрузки:
  - Подключение по консоли.
  - Проверка версии ОС: `cat /etc/os-release`.
  - Проверка IP-адреса: `ip a`.
  - Подключение по SSH: `ssh admin@<ip>`.

### Упражнения для закрепления

#### Лёгкие
- Скачайте ISO Rocky Linux и создайте виртуальную машину в VirtualBox.
- Запустите систему и убедитесь, что работает сеть (команда `ping 8.8.8.8`).

#### Средние
- Создайте снимок (snapshot) виртуальной машины после установки, чтобы можно было откатиться.

#### Сложные
- Если удалось создать снимок ВМ, то попробовать вывести из строя ОС и выполнить восстановление из снимка.
- Попробуйте установить дополнения гостевой ОС VirtualBox (Guest Additions) и подключить общую папку с хостом.

---

## Модуль 1. Подготовка и работа с системой (на примере RPM-дистрибутива, например, CentOS Stream 9 / Rocky Linux 9)

### Теория и навыки
- Что такое RPM-дистрибутивы, чем отличаются от Debian-подобных. Какие лучше использовать для серверов.
- Получение справки по утилитам с помощью утилиты man. Например, `man du`
- Как получить базовую информацию о системе: `uname -a`, `cat /etc/os-release`, `hostnamectl`.
- Как посмотреть ресурсы: `top`, `htop`, `free -h`, `df -h`, `du -sh`, `uptime`.
- Директории Linux (более подробная статья https://habr.com/ru/companies/otus/articles/930646/):
  - `/` — корневая файловая система.
  - `/bin`, `/sbin` — системные команды.
  - `/etc` — конфигурационные файлы.
  - `/home` — домашние каталоги пользователей.
  - `/var` — логи, временные данные.
  - `/usr` — приложения и библиотеки.
  - `/tmp` — временные файлы.
  - `/opt` — опциональные/дополнительные пакеты и программы.
  - `/boot` — директория с загрузочными файлами ОС
  - `/root` — домашняя директория пользователя root
- Управление пользователями: `useradd`, `passwd`, `usermod`, `id`, `groups`, `su`.
- Права и типы файлов: чтение/запись/выполнение (`ls -l`), изменение (`chmod`, `chown`, `chgrp`).
- Установка пакетов: `dnf install`, `dnf remove`, `dnf update`, `dnf search`.
- Логи: `journalctl`, `/var/log/messages`, `/var/log/secure`, `dmesg`.
- Часто используемые команды админа: `systemctl`, `ps aux`, `kill`, `netstat -tulnp` / `ss -tulnp`, `ip a`, `ping`, `curl`, `scp`, `rsync`, `grep`, `awk`.
- Работа с файлами `head`, `tail`, `cat`, `touch`
- Выбор текстового редактора (легкий - nano, сложный - vi/vim). Создание и редактирование файлов с помощью текстового редактора.
- Настройка sudo: файл `/etc/sudoers`, группа `wheel`. Управление правами пользователей, выполнение операций с помощью sudo.

### Упражнения для закрепления

#### Лёгкие
- Узнайте версию системы и ядра с помощью двух разных команд.
- Создайте нового пользователя `devadmin` и зайдите под ним.
- Посмотрите, сколько места занимает `/var`.

#### Средние
- Настройте паролю пользователя `devadmin` срок действия на 30 дней. Проверьте, как это отображается в выводе команды по смене срока пароля. Установите пароль в бессрочный.
- Установите пакет `htop` и убедитесь, что он работает.
- Создайте файл `only_owner` в `/tmp`, измените права так, чтобы только владелец мог читать и писать. Зайдите под пользователем admin и попытайтесь прочитать данные из файла, вы дожны получить "permission denied"
- Создать текстовый файл в своей домашней директории командой `touch`. Посмотреть данные о файле командами `du`, `file`, `ls -al` Записать текстовую строку в него БЕЗ использования текстового редактора (изучить немного перенаправление потока данных с помощью операторов `>`, `>>` и утилиты `tee`. Сделать вывод данных из файла на экран. Добавить еще несколько строк в файл БЕЗ текстового редактора. Сделать вывод данных на экран.

#### Сложные
- Создайте группу `admins`, добавьте туда пользователя `devadmin` и настройте, чтобы он мог выполнять команды от имени суперпользователя через `sudo`.
- Настройте сервис `sshd` так, чтобы root не мог подключаться по SSH.
- Настройте сервис `sshd` так, чтобы пользователи группы admins могли подключаться по SSH.
- Настройте сервис `sshd` так, чтобы подключиться можно было только с помощью ключей, а не по паролю. Подключитесь по ключу пользователем devadmin.

#### Очень сложные
- Соберите список всех процессов, которые используют больше 10% CPU, и сохраните его в файл `/home/devadmin/proclist.txt`.

---

## Модуль 2. Работа с пользователями, правами, пакетами и логами

### Теория и навыки
- Что такое пользователь root. Какие привилегии у него есть. Безопасность использования пользователя root
- Управление пользователями и группами глубже: `/etc/passwd`, `/etc/group`, `/etc/shadow`.
- Типы файлов в Linux: обычные файлы, директории, символьные ссылки, устройства, сокеты.
- Управление правами доступа через числовую и символьную форму (`chmod 644`, `chmod u+x file`).
- Проверка владельца: `stat`, `ls -ld`.
- Работа с пакетами и репозиториями: `dnf repolist`, `dnf info`, подключение EPEL.
- Управление сервисами: `systemctl start/stop/enable/status`.
- Работа с логами через `journalctl -u <service>`, фильтрация по времени.

### Упражнения для закрепления

#### Лёгкие
- Просмотрите список пользователей в системе
- Просмотрите список групп в системе
- Просмотрите права на файл /etc/passwd и узнайте в поисковой системе или у llm почему они такие на данном файле.
- Узнайте, какие пакеты установлены в системе, содержащие слово `python`.
- Посмотрите последние 20 строк системного журнала.

#### Средние
- Создайте пользователя `newshell`. Настройте пользователя так, чтобы при входе он попадал в нестандартную оболочку (например, `/bin/sh`). Выполните проверку через различные механизмы (`su`, `sudo`)
- Настройте службу `crond` так, чтобы она запускалась автоматически после перезагрузки.
- Создайте символьную ссылку на файл в `/etc`, сохраните её в `/home/devadmin/`.

#### Сложные
- Создайте пользователя `status`. Настройте sudo так, чтобы пользователь `status` мог запускать только команды `systemctl status` и `journalctl` без пароля.
- Настройте таймер systemd (unit .timer), который будет запускать скрипт очистки временных файлов в `/tmp` каждые 10 минут. Проверьте работу юнита
- Создайте systemd unit-файл для своего скрипта, который выводит дату и время в файл `/tmp/datetime.log` каждые 10 секунд.

